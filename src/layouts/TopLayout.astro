---
import type { CollectionEntry } from "astro:content";
import { formatDate, readingTime, getBreadcrumbs } from "../lib/utils";

type Props = {
  entry: CollectionEntry<"projects"> | CollectionEntry<"blog">
};

const { entry } = Astro.props;
const { collection, data, body } = entry;
const { title, summary, date } = data;
const { slug } = entry;
const breadcrumbs = getBreadcrumbs(slug);

const demoUrl = collection === "projects" ? data.demoUrl : null;
const repoUrl = collection === "projects" ? data.repoUrl : null; 
---

<div class="flex flex-col items-center text-center justify-center py-16">
  <nav class="items-center text-sm text-muted-foreground mb-6">
    <ol class="flex items-center text-center space-x-1">
      <li>
        <a href="/" class="uppercase hover:text-[var(--color-fg)] text-[var(--color-muted)]"></i>Home</a>
      </li>
      <li><i class="ri-arrow-drop-right-line"></i></li>
      <li>
        <a href={`/${collection}`} class="uppercase hover:text-[var(--color-fg)] text-[var(--color-muted)]">
          {collection}
        </a>
      </li>
      {breadcrumbs.map((crumb, i) => (
        <>
          <li><i class="ri-arrow-drop-right-line"></i></li>
          <li class={i === breadcrumbs.length - 1 ? "uppercase text-[var(--color-fg)] font-medium truncate max-w-[150px] sm:max-w-xs" : "text-[var(--color-muted)]"}>
            {i === breadcrumbs.length - 1 ? (
              <span>{crumb.name}</span>
            ) : (
              <a href={`/${collection}${crumb.href}`} class="uppercase hover:underline">
                {crumb.name}
              </a>
            )}
          </li>
        </>
      ))}
    </ol>
  </nav>  
  <h1 class="text-4xl py-6 font-semibold text-[var(--color-fg)]">
    {title}
  </h1>
  <div class="flex flex-wrap text-sm uppercase py-2 gap-3 opacity-75 items-center w-auto">
    <div class="flex items-center text-center gap-2 flex-1">
      <i class="ri-calendar-line text-base"></i>
      {formatDate(date)}
    </div>
    <div class="flex items-center text-center gap-2 flex-wrap">
      <i class="ri-book-open-line text-base"></i>
      {readingTime(body)}
    </div>
  </div>
  <p class="text-[var(--color-muted)] mt-1">
    {summary}
  </p>
  {(demoUrl || repoUrl) && (
    <div class="mt-6 flex flex-wrap gap-3">
      {demoUrl && (
        <a href={demoUrl} target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 rounded border border-border px-4 py-2 text-sm hover:bg-black/5 dark:hover:bg-white/10 transition">
          <i class="ri-earth-line"></i> <span>See Demo</span>
        </a>
      )}
      {repoUrl && (
        <a href={repoUrl} target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 rounded border border-border px-4 py-2 text-sm hover:bg-black/5 dark:hover:bg-white/10 transition">
          <i class="ri-github-line"></i> <span>See Repository</span>
        </a>
      )}
    </div>
  )}
</div>
