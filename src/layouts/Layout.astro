---
// src/layouts/Layout.astro
import "../styles/global.css";
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.tsx';
import BackToTop from '../components/BackToTop.tsx';
import StatusIndicator from '../components/StatusIndicator.astro';
import Footer from '../components/Footer.astro';
import { SITE } from "../consts"
import ReadingProgress from '../components/ReadingProgress.tsx';

const { title, description } = Astro.props;
---

<!doctype html>
<html lang="id">
    <head>
        <BaseHead title={`${title} | ${SITE.TITLE}`} description={description} />
    </head>
    <body>
        <Header client:idle />
        <ReadingProgress client:load /> 
        <main>
            <slot />
        </main>
        <BackToTop client:visible />
	    <StatusIndicator />
        <Footer />
        <script is:inline>
            document.addEventListener('DOMContentLoaded', () => {
                const codeBlocks = document.querySelectorAll('.prose pre');
            
                codeBlocks.forEach(block => {

                const wrapper = document.createElement('div');
                wrapper.style.position = 'relative';
                block.parentNode.insertBefore(wrapper, block);
                wrapper.appendChild(block);

                const copyButton = document.createElement('button');
                copyButton.className = 'copy-code-button';
                copyButton.textContent = 'Copy';
                wrapper.appendChild(copyButton);
            
                copyButton.addEventListener('click', () => {
                    const code = block.querySelector('code').innerText;
                    navigator.clipboard.writeText(code).then(() => {
                    copyButton.textContent = 'Copied!';
                    setTimeout(() => {
                        copyButton.textContent = 'Copy';
                    }, 2000);
                    });
                });
                });
            });
        </script>
    </body>
</html>