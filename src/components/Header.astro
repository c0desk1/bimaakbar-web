---
// src/components/Header.astro
import { SITE, LINKS } from "../consts";
import Container from "./Container.astro";
import ThemeToggleButton from "./ThemeToggleButton.tsx";
import { Image } from "astro:assets";
import logo from "../assets/brand-astro.svg";
import HeaderLink from "./HeaderLink.astro";
---
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const header = document.querySelector('header[aria-label="Base Header"]');
    const mobileMenuButton = document.getElementById("mobile-menu-toggle");

    let isMenuOpen = false;
    const scrollThreshold = 10;
    let isScrolled = false;

    const toggleMenu = () => {
      isMenuOpen = !isMenuOpen;

      if (mobileMenuButton) {
        mobileMenuButton.setAttribute("aria-expanded", isMenuOpen.toString());
        mobileMenuButton.innerHTML = isMenuOpen
          ? '<i class="ri-close-circle-line" aria-hidden="true"></i>'
          : '<i class="ri-menu-5-line" aria-hidden="true"></i>';
      }

      document.body.style.overflow = isMenuOpen ? "hidden" : "auto";

      window.dispatchEvent(
        new CustomEvent("mobileMenuToggle", { detail: { isOpen: isMenuOpen } })
      );
    };

    if (mobileMenuButton) {
      mobileMenuButton.addEventListener("click", toggleMenu);
    }

    const handleScroll = () => {
      const scrolledCurrently = window.scrollY > scrollThreshold;
      if (scrolledCurrently !== isScrolled) {
        isScrolled = scrolledCurrently;
        if (header) {
          header.classList.toggle("is-scrolled", isScrolled);
        }
      }
    };

    window.addEventListener("scroll", handleScroll);
    handleScroll();
  });
</script>

<header class="fixed top-0 z-50 w-full transition-all oveflow-hidden duration-300 bg-transparent border-b border-transparent backdrop-blur-md [&.is-scrolled]:bg-[var(--color-card-bg)] [&.is-scrolled]:border-[var(--color-border)]">
  <Container size="lg">
    <div class="flex items-center justify-between py-4 h-16">
      <div class="flex-1 items-center">
        <a href="/" aria-label={`Beranda ${SITE.TITLE}`} class="flex gap-2 items-center text-[var(--color-fg)] text-xl hover:text-[var(--color-fg)]">
          
          <svg  xmlns="http://www.w3.org/2000/svg"  width="36"  height="36"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor" troke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-astro stroke-current text-[var(--color-fg)]"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14.972 3.483c.163 .196 .247 .46 .413 .987l3.64 11.53a15.5 15.5 0 0 0 -4.352 -1.42l-2.37 -7.723a.31 .31 0 0 0 -.296 -.213a.31 .31 0 0 0 -.295 .214l-2.342 7.718a15.5 15.5 0 0 0 -4.37 1.422l3.657 -11.53c.168 -.527 .251 -.79 .415 -.986c.144 -.172 .331 -.306 .544 -.388c.242 -.094 .527 -.094 1.099 -.094h2.612c.572 0 .858 0 1.1 .094c.213 .082 .4 .217 .545 .39" /><path d="M9 18c0 1.5 2 3 3 4c1 -1 3 -3 3 -4q -3 1.5 -6 0" /></svg>
        </a>
        <span class="hidden font-semibold text-center">{SITE.TITLE}</span>
      </div>
      <nav class="hidden md:flex items-center gap-4" aria-label="Navigasi desktop">
        {LINKS.map((link) => (
          <HeaderLink
            href={link.HREF}
            aria-label={`Menu ${link.TEXT}`}>
            {link.TEXT}
          </HeaderLink>
        ))}
      </nav>
      <div class="flex-1 flex items-center justify-end gap-4">
        <div class="hidden md:flex gap-4">
          <ThemeToggleButton client:visible aria-label="Toggle tema gelap atau terang" />
        </div>
      </div>
      <div class="md:hidden">
        <button id="mobile-menu-toggle" aria-label="Menu mobile" aria-expanded="false" class="text-xl p-2">
            <i class="ri-menu-5-line" aria-hidden="true"></i>
        </button>
      </div>
    </div>
  </Container>
</header>
