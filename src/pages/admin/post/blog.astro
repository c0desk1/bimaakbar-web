---
import AdminLayout from '../../../layouts/AdminLayout.astro';
import { fetchBlog } from '../../../utils/fetchBlog';
import { type Blog } from '../../../types';
import CreatePosts from '../../../components/CreatePosts.tsx';

const blogs: Blog[] = await fetchBlog();
---

<AdminLayout>
<CreatePosts client:load />
  <section class="px-4 py-6 max-w-screen-lg mx-auto">
    <h1 class="text-2xl font-semibold mb-6">Postingan Blog</h1>
    {blogs.length === 0 ? (
      <p class="text-muted italic">Tidak ada data blog.</p>
    ) : (
      <table class="w-full text-sm border-collapse">
        <thead>
          <tr class="bg-[var(--color-bg-secondary)]">
            <th class="text-left p-3 border-b">Judul</th>
            <th class="text-left p-3 border-b">Slug</th>
            <th class="text-left p-3 border-b">Status</th>
            <th class="text-left p-3 border-b">Tanggal</th>
          </tr>
        </thead>
        <tbody>
          {blogs.map((post) => (
            <tr class="border-b hover:bg-gray-50 dark:hover:bg-neutral-900 transition">
              <td class="p-3">{post.title}</td>
              <td class="p-3 text-muted">{post.slug}</td>
              <td class="p-3">
                <span class={post.status === 'PUBLISH' ? 'text-green-600' : 'text-yellow-500'}>
                  {post.status}
                </span>
              </td>
              <td class="p-3">{post.date ? new Date(post.date).toLocaleDateString('id-ID') : '-'}</td>
            </tr>
          ))}
        </tbody>
      </table>
    )}
  </section>
</AdminLayout>
