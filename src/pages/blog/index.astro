---
import { BLOG } from "../../consts";
import BaseLayout from '../../layouts/BaseLayout.astro';
import TopLayout from '../../layouts/TopLayout.astro';
import BottomLayout from '../../layouts/BottomLayout.astro';
import Container from "../../components/Container.astro";
import BlogList from '../../components/BlogList.tsx';
import Navigation from '../../components/Navigation.astro';
import { fetchBlog } from '../../utils/fetchBlog';

const posts = (await fetchBlog()).filter(post => post.status === 'PUBLISH');
const estimated_initial_size = 28 + posts.length * 158 + (posts.length - 1) * 12;
---
<script is:inline src="//www.highperformanceformat.com/9ec096002c2fad1b9d684a8a1057f653/invoke.js"></script>
<BaseLayout title={BLOG.TITLE} description={BLOG.DESCRIPTION}>
  <Container size="md">
    <TopLayout>
      <section class="py-6">
        <div class="flex flex-col justify-start text-left">
          <h1 class="text-2xl md:text-3xl font-bold uppercase text-[var(--color-fg)]">
            {BLOG.TITLE}
          </h1>
          <p class="text-sm md:text-base opacity-75">
            {BLOG.DESCRIPTION}
          </p>
        </div>
      </section>
    </TopLayout>
      <section class="py-6">
        <script type="text/javascript">
          atOptions = {
            'key': '9ec096002c2fad1b9d684a8a1057f653',
            'format': 'iframe',
            'height': 60,
            'width': 468,
            'params': {},
            'accessibility': 'Ads'
          };
        </script>
        <div style={{ minHeight: `${estimated_initial_size}px` }}>
          <BlogList client:load />
        </div>
      </section>
    <BottomLayout>
      <Navigation />
    </BottomLayout>
  </Container>
</BaseLayout>
