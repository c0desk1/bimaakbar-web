---
import { fetchBlog } from '../../../utils/fetchBlog'
import BaseLayout from '../../../layouts/BaseLayout.astro'
import TopLayout from '../../../layouts/TopLayout.astro'
import BottomLayout from '../../../layouts/BottomLayout.astro'
import Container from "../../../components/Container.astro"
import Hero from "../../../components/Hero.astro"
import PostCard from '../../../components/PostCard.tsx'
import {BLOG} from '../../../consts';


const { category } = Astro.params;
const allPosts = await fetchBlog();
const postsByCategory = allPosts
  .filter(post => post.category === category && post.status === 'PUBLISHED');

const pageTitle = postsByCategory.length > 0
  ? `Kategori`
  : `Belum ada postingan di kategori`;
---
<BaseLayout title={pageTitle || category } description={category}>
    <TopLayout>
      <Hero title={category} subtitle={`Daftar postingan kategori: ${category}`} />
    </TopLayout>
    <Container size="md">
      {postsByCategory.length > 0 ? (
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3 py-6">
          {postsByCategory.map(post => (
            <PostCard client:load post={post} />
          ))}
        </div>
        ) : (
        <p class="text-[var(--color-muted)]">Tidak ada postingan dengan kategori: <strong>{category}</strong></p>
      )}
    </Container>
    <BottomLayout>
     <a href="/" class="group flex w-auto mt-6 items-center gap-2 rounded-xl bg-[var(--color-bg)] border border-[var(--color-border)] px-2 py-1 text-[var(--color-fg)] hover:bg-[var(--color-hover)]">
        <div class="flex w-full items-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="items-center stroke-[var(--color-muted)] group-hover:stroke-[var(--color-fg)]">
            <line x1="19" y1="12" x2="5" y2="12" class="scale-x-0 group-hover:scale-x-100 translate-x-3 group-hover:translate-x-0 transition-all duration-300 ease-in-out" />
            <polyline points="12 19 5 12 12 5" class="translate-x-1 group-hover:translate-x-0 transition-all duration-300 ease-in-out" />
          </svg>
          <span class="w-full items-center">
            Kembali ke {BLOG.title}
          </span>
        </div>
      </a> 
    </BottomLayout> 
  
</BaseLayout>
